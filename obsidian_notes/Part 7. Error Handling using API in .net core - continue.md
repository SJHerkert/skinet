Overview: Continuation of Error Handling.

---

Validation errors
Middleware
Swagger

---

Validation errors
	User input - read - error
	Flattening our error response instead of objects.
	In Error folder new class
		ApiValidationErrorResponse.cs
		Overwrite [ApiController]
		Use Modelstate(If any errors present in apicontroller then it stores? them in a modelstate) to extract errors if any and pass them into APiValidationErrorResponse Error property.
Swagger
	Nuget - swashbuckle.asp.net.core swagger gen
	Nuget - swashbuckle.asp.net.core swaggerui
	dotnet restore
	Add service in Program.cs
		builder.Services.AddSwaggerGen(c =>
	        {
	            c.SwaggerDoc("v1", new OpenApiInfo {Title = "Skinet Api", Version = "v1"});
	        });
        Add this as middleware
	        Under  app.UseAuthorization();
				app.UseSwagger();
	http://localhost:5079/swagger/v1/swagger.json
	http://localhost:5079/swagger/index.html
	fail: API.Middleware.ExceptionMiddleware[0]
      Ambiguous HTTP method for action - API.Controllers.ErrorController.Error (API). Actions require an explicit HttpMethod binding for Swagger/OpenAPI 3.0     
      Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Ambiguous HTTP method for action - API.Controllers.ErrorController.Error (API). Actions require an explicit HttpMethod binding for Swagger/OpenAPI 3.0
	Excluding our ErrorController from swagger(as our ErrorController is working so that it can handle any error response, and we can exclude it from swagger)
		In errorController under [Microsoft.AspNetCore.Mvc.Route("errors/{code}")]
			add [ApiExplorerSettings(IgnoreApi = true)]
	Removing our WeatherForecastController from our swagger list.
	How to improve our documentation in swagger to tell Swagger what else to expect as a response from our endpoints.
		In ProductsController under GetProduct method add under GetentityWithSpec(spec)
			        if (product == null) return NotFound(new ApiResponse(404));
				        Now in swagger we see the response 404 if we input wrong id, but in there it also mentioins that this response is undocumented. To tell swagger we can tell what we are returning from our response.
					        In same GetProduct
						            [HttpGet("{id}")]
							    [ProducesResponseType(StatusCodes.Status200OK)]
							    [ProducesResponseType(StatusCodes.Status404NotFound)]
								    This returns not the exact error message as we are returning to change this add
										[HttpGet("{id}")]
											    [ProducesResponseType(StatusCodes.Status200OK)]
											    [ProducesResponseType(typeof(ApiResponse), StatusCodes.Status404NotFound)]
House keeping and cleaning the Program.cs (Middleware)
	New folder called Extensions
		New class called ApplicationServicesExtensions.cs
			Move from Program.cs the following
				Reposityory parts and validation error part
			In Program.cs under builder.Services.AddDbContext(...
				builder.Services.AddApplicationServices();
				using API.Extensions;
		New class called SwaggerServiceExtensions.cs
			Do same as previous step.

Pushing Changes to GitHub
	 git add .
	 git commit -m "End of Section 4"
	 git push origin main

Section done.

*end of tutorial part2*
*tutorial 34min, used time 2h*

Summary of parts 6 and 7
"Configurated error handling system in our API. Consistent responses that we can now return to the client. "Goal was to enhance Out of the box error handling, and retun consistent response for all errors generated by the API."-author "

---

***dotnet commands:***
	dotnet restore
***Visual Studio Code commands:***	
	Ctrl + Shft + P (Nuget)

---

Tutorial Issues(0)
Notes(0)

---
*Start Date: 05.04.2025
*End Date: 05.04.2025*
*Time Spent: 2h*
	*Setup: *
	*Notes *
	*Video*
*Tutorial Video length: 34min*

*About time management:* 
"No time management issues."

---
*Tutorial link:*
*[Error Handling using API in .net core continue part 7](https://www.youtube.com/watch?v=_AlbeFbv2hs&list=PLaR3RrvBxlc3c8NAtlAXRwx43ZdH8eBrQ&index=8)*

*Related links:*
*Any related links*

*Interesting links:*
*Any interesting links*